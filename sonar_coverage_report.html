<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>代码质量分析报告</title><script src="https://cdn.jsdelivr.net/npm/echarts@5.4.0/dist/echarts.min.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet"><style>:root{--primary-color:#1890ff;--success-color:#52c41a;--error-color:#ff4d4f;--text-primary:#262626;--text-secondary:#8c8c8c;--bg-color:#f0f2f5;--card-bg:#ffffff;--border-radius:4px}body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background-color:var(--bg-color);margin:0;padding:16px;color:var(--text-primary)}.container{max-width:1200px;margin:0 auto}.header{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}.header h1{margin:0;font-size:20px;font-weight:600}.header .timestamp{color:var(--text-secondary);font-size:12px;background:#fff;padding:4px 12px;border-radius:12px;box-shadow:0 1px 3px rgba(0,0,0,0.1)}.summary-row{display:grid;grid-template-columns:repeat(4,1fr);gap:12px;margin-bottom:16px}@media (max-width:768px){.summary-row{grid-template-columns:repeat(2,1fr)}}.card{background:var(--card-bg);padding:16px;border-radius:var(--border-radius);box-shadow:0 1px 2px rgba(0,0,0,0.1);transition:transform 0.2s}.card:hover{transform:translateY(-1px)}.card-title{color:var(--text-secondary);font-size:12px;margin-bottom:4px}.card-value{font-size:24px;font-weight:bold;color:var(--text-primary)}.card-icon{float:right;font-size:20px;opacity:0.2}.chart-section{background:var(--card-bg);border-radius:var(--border-radius);padding:16px;margin-bottom:16px;box-shadow:0 1px 2px rgba(0,0,0,0.1)}.data-section{background:var(--card-bg);border-radius:var(--border-radius);padding:16px;box-shadow:0 1px 2px rgba(0,0,0,0.1)}.toolbar{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;flex-wrap:wrap;gap:8px}.filter-group{display:flex;gap:6px}.btn{border:1px solid #d9d9d9;background:#fff;padding:4px 12px;border-radius:4px;cursor:pointer;transition:all 0.2s;color:var(--text-primary);font-size:12px}.btn.active{border-color:var(--primary-color);color:var(--primary-color);background:#e6f7ff}.btn:hover{color:var(--primary-color);border-color:var(--primary-color)}.search-box{position:relative}.search-box input{padding:6px 8px 6px 28px;border:1px solid #d9d9d9;border-radius:4px;width:200px;outline:none;transition:border-color 0.3s;font-size:12px}.search-box input:focus{border-color:var(--primary-color);box-shadow:0 0 0 2px rgba(24,144,255,0.2)}.search-icon{position:absolute;left:8px;top:50%;transform:translateY(-50%);color:var(--text-secondary);font-size:12px}table{width:100%;border-collapse:collapse}th{text-align:left;padding:12px 8px;background:#fafafa;border-bottom:1px solid #f0f0f0;color:var(--text-primary);cursor:pointer;user-select:none;transition:background 0.2s;font-size:12px}th:hover{background:#f0f0f0}td{padding:12px 8px;border-bottom:1px solid #f0f0f0;transition:background 0.2s;font-size:12px}tr:hover td{background:#fafafa}.progress-bar-bg{background-color:#f5f5f5;height:6px;border-radius:3px;width:100%;max-width:120px;overflow:hidden;display:inline-block;vertical-align:middle;margin-right:6px}.progress-bar-fill{height:100%;border-radius:3px;transition:width 0.4s ease}.status-badge{display:inline-block;padding:2px 6px;border-radius:3px;font-size:11px;border:1px solid}.status-pass{background:#f6ffed;border-color:#b7eb8f;color:#52c41a}.status-fail{background:#fff2f0;border-color:#ffccc7;color:#ff4d4f}.sort-icon{margin-left:4px;color:#bfbfbf;font-size:10px}.sort-active{color:var(--primary-color)}@media (max-width:768px){.summary-row{grid-template-columns:1fr 1fr;gap:12px}.toolbar{flex-direction:column;align-items:stretch}.search-box input{width:100%}table{font-size:10px}th,td{padding:8px 4px}}</style></head>
<body><div class="container"><div class="header"><h1>代码质量覆盖率看板</h1><div class="timestamp"><i class="far fa-clock"></i> 01-19 15:33</div></div><div class="summary-row">
            <div class="card">
                <i class="fas fa-cube card-icon" style="color: #1890ff;"></i>
                <div class="card-title">项目总数</div>
                <div class="card-value">7</div>
            </div>
            <div class="card">
                <i class="fas fa-check-circle card-icon" style="color: #52c41a;"></i>
                <div class="card-title">达标率 (≥50.0%)</div>
                <div class="card-value">71.4%</div>
            </div>
            <div class="card">
                <i class="fas fa-chart-line card-icon" style="color: #722ed1;"></i>
                <div class="card-title">平均新代码覆盖率</div>
                <div class="card-value">43.2%</div>
            </div>
            <div class="card">
                <i class="fas fa-exclamation-triangle card-icon" style="color: #ff4d4f;"></i>
                <div class="card-title">需关注项目</div>
                <div class="card-value" style="color: var(--error-color)">2</div>
            </div>
</div><div class="chart-section"><div id="mainChart" style="width:100%;height:400px"></div></div><div class="data-section">
<div class="toolbar"><div class="filter-group"><button class="btn active" onclick="filterStatus('all', this)">全部</button><button class="btn" onclick="filterStatus('pass', this)">达标</button><button class="btn" onclick="filterStatus('fail', this)">未达标</button></div><div class="search-box"><i class="fas fa-search search-icon"></i><input type="text" id="searchInput" placeholder="搜索项目..." onkeyup="handleSearch()"></div></div><table><thead><tr><th onclick="sortTable('project_key')">项目名称 <i class="fas fa-sort sort-icon" id="sort-project_key"></i></th><th onclick="sortTable('overall_coverage')">整体覆盖率 <i class="fas fa-sort sort-icon" id="sort-overall_coverage"></i></th><th onclick="sortTable('new_coverage')">新代码覆盖率 <i class="fas fa-sort sort-icon" id="sort-new_coverage"></i></th><th onclick="sortTable('status')">状态 <i class="fas fa-sort sort-icon" id="sort-status"></i></th></tr></thead><tbody id="tableBody"></tbody></table></div></div>

<script>
const rawData=[{"project_key": "oms-api", "overall_coverage": 28.5, "new_coverage": 55.1, "timestamp": "2026-01-19 15:33:47", "status": "pass"}, {"project_key": "rps-api", "overall_coverage": 11.1, "new_coverage": 57.0, "timestamp": "2026-01-19 15:33:47", "status": "pass"}, {"project_key": "drivermgmt-api", "overall_coverage": 15.4, "new_coverage": 17.8, "timestamp": "2026-01-19 15:33:49", "status": "fail"}, {"project_key": "tracking-api", "overall_coverage": 20.1, "new_coverage": 57.0, "timestamp": "2026-01-19 15:33:50", "status": "pass"}, {"project_key": "pos-exchange-api", "overall_coverage": 10.4, "new_coverage": 54.0, "timestamp": "2026-01-19 15:33:51", "status": "pass"}, {"project_key": "pos-admin-api", "overall_coverage": 9.6, "new_coverage": 50.0, "timestamp": "2026-01-19 15:33:52", "status": "pass"}, {"project_key": "pos-api", "overall_coverage": 9.6, "new_coverage": 11.4, "timestamp": "2026-01-19 15:33:53", "status": "fail"}];
const threshold=50.0;
let currentFilter='all';
let sortConfig={key:'new_coverage',dir:'asc'};
window.onload=function(){renderChart();applyFilterAndSort()};
function renderChart(){
  const chartDom=document.getElementById('mainChart');
  const myChart=echarts.init(chartDom);
  const option={
    tooltip:{trigger:'axis',axisPointer:{type:'shadow'}},
    legend:{bottom:5,textStyle:{fontSize:12}},
    grid:{left:'30px',right:'80px',bottom:'60px',top:'40px',containLabel:true},
    xAxis:{type:'category',data:rawData.map(i=>i.project_key),axisLabel:{rotate:30,color:'#666'}},
    yAxis:{type:'value',min:0,max:100,interval:10,splitLine:{lineStyle:{type:'dashed',color:'#eee'}},axisLabel:{formatter:function(v){return v+"%"}}},
    series:[
      {name:'整体覆盖率',type:'bar',barGap:0.2,itemStyle:{color:'#1890ff',borderRadius:[2,2,0,0]},data:rawData.map(i=>i.overall_coverage)},
      {name:'新代码覆盖率',type:'bar',itemStyle:{color:function(p){return p.value<threshold?'#ff4d4f':'#52c41a'},borderRadius:[2,2,0,0]},data:rawData.map(i=>i.new_coverage),markLine:{data:[{yAxis:threshold}],lineStyle:{color:'#faad14',type:'dashed',width:2},symbol:'none',label:{show:true,position:'insideEndTop',formatter:function(){return threshold+"%"},color:'#faad14',fontSize:12,fontWeight:'bold'}}}
    ]
  };
  myChart.setOption(option);
  window.addEventListener('resize',()=>myChart.resize());
  myChart.on('click',function(p){document.getElementById('searchInput').value=p.name;handleSearch();document.querySelector('.data-section').scrollIntoView({behavior:'smooth'})});
}
function handleSearch(){applyFilterAndSort()}
function filterStatus(s,btn){currentFilter=s;document.querySelectorAll('.filter-group .btn').forEach(b=>b.classList.remove('active'));btn.classList.add('active');applyFilterAndSort()}
function sortTable(key){if(sortConfig.key===key){sortConfig.dir=sortConfig.dir==='asc'?'desc':'asc'}else{sortConfig.key=key;sortConfig.dir='desc'}applyFilterAndSort();updateSortIcons(key,sortConfig.dir)}
function applyFilterAndSort(){const q=document.getElementById('searchInput').value.toLowerCase();let temp=rawData.filter(item=>{return item.project_key.toLowerCase().includes(q)&&(currentFilter==='all'||item.status===currentFilter)});temp.sort((a,b)=>{let vA=a[sortConfig.key],vB=b[sortConfig.key];if(typeof vA==='string')return sortConfig.dir==='asc'?vA.localeCompare(vB):vB.localeCompare(vA);return sortConfig.dir==='asc'?vA-vB:vB-vA});renderTable(temp)}
function renderTable(data){const tbody=document.getElementById('tableBody');tbody.innerHTML='';if(data.length===0){tbody.innerHTML='<tr><td colspan="4" style="text-align:center;padding:20px;color:#999">没有找到匹配的数据</td></tr>';return}data.forEach(item=>{const row=document.createElement('tr');const overallHtml=createProgress(item.overall_coverage,'#1890ff');const newHtml=createProgress(item.new_coverage,item.new_coverage<threshold?'#ff4d4f':'#52c41a');const badgeClass=item.status==='pass'?'status-pass':'status-fail';const badgeText=item.status==='pass'?'达标':'未达标';row.innerHTML=`<td style="font-weight:500">${item.project_key}</td><td>${overallHtml}</td><td>${newHtml}</td><td><span class="status-badge ${badgeClass}">${badgeText}</span></td>`;tbody.appendChild(row)});}
function createProgress(v,c){return `<div class="progress-bar-bg"><div class="progress-bar-fill" style="width:${v}%;background-color:${c}"></div></div><span>${v}%</span>`}
function updateSortIcons(k,d){document.querySelectorAll('.sort-icon').forEach(i=>{i.className='fas fa-sort sort-icon'});const t=document.getElementById(`sort-${k}`);if(t){t.className=`fas fa-sort-${d==='asc'?'up':'down'} sort-icon sort-active`}}
</script>
</body></html>